<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot-megas VODACOM - Compre Seus Megas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-up { animation: slideUp 0.3s ease-out; }
        .message-container { scroll-behavior: smooth; }
    </style>
</head>
<body class="bg-gradient-to-br from-emerald-50 via-white to-green-50 min-h-screen flex flex-col">
    
    <!-- Header -->
    <header class="bg-gradient-to-r from-emerald-500 to-green-600 text-white shadow-lg">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 py-4 sm:py-6">
            <div class="flex items-center space-x-3 sm:space-x-4">
                <div class="relative">
                    <div class="absolute inset-0 bg-white rounded-2xl blur-lg opacity-40 animate-pulse"></div>
                    <div class="relative bg-white rounded-2xl p-2 sm:p-3 transform hover:scale-110 transition-transform">
                        <span class="text-3xl sm:text-5xl">ü§ñ</span>
                    </div>
                </div>
                <div>
                    <h1 class="text-xl sm:text-3xl font-bold">Bot-megas VODACOM</h1>
                    <p class="text-emerald-100 text-xs sm:text-sm mt-1">Compre seus megas de forma r√°pida e segura</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Messages Area -->
    <main id="messagesArea" class="flex-1 overflow-y-auto p-4 sm:p-6 message-container"></main>

    <!-- Input Area -->
    <div id="inputArea" class="hidden bg-white border-t-4 border-emerald-500 p-4 sm:p-6 shadow-2xl">
        <div class="max-w-3xl mx-auto flex space-x-3">
            <input
                type="text"
                id="phoneInput"
                placeholder="Digite seu n√∫mero..."
                class="flex-1 border-2 border-gray-300 rounded-2xl px-4 sm:px-6 py-3 sm:py-4 focus:outline-none focus:ring-4 focus:ring-emerald-300 focus:border-emerald-500 text-base sm:text-lg"
            />
            <button
                id="sendBtn"
                class="bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white rounded-2xl px-6 sm:px-8 shadow-lg transition-all transform hover:scale-105"
            >
                <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Review Modal -->
    <div id="reviewModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-3xl shadow-2xl max-w-md w-full p-6 sm:p-8">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-yellow-100 rounded-full mb-4">
                    <svg class="w-8 h-8 text-yellow-500 fill-yellow-500" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                </div>
                <h2 class="text-xl sm:text-2xl font-bold text-gray-800 mb-2">Avalie nosso servi√ßo</h2>
                <p class="text-sm sm:text-base text-gray-600">Sua opini√£o nos ajuda a melhorar</p>
            </div>

            <div class="mb-6">
                <p class="text-sm text-gray-700 font-medium mb-3 text-center">Classifica√ß√£o:</p>
                <div id="starRating" class="flex justify-center space-x-2">
                    <!-- Stars will be generated by JS -->
                </div>
            </div>

            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Coment√°rio (opcional):</label>
                <textarea
                    id="reviewText"
                    placeholder="Conte-nos sua experi√™ncia..."
                    rows="4"
                    class="w-full border-2 border-gray-300 rounded-xl px-4 py-3 focus:outline-none focus:ring-4 focus:ring-emerald-300 focus:border-emerald-500 resize-none text-sm sm:text-base"
                ></textarea>
            </div>

            <div class="space-y-3">
                <button
                    id="submitReviewBtn"
                    class="w-full bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white font-bold py-3 sm:py-4 px-6 rounded-2xl shadow-lg transition-all transform hover:scale-105"
                >
                    Enviar Avalia√ß√£o
                </button>
                <button
                    id="skipReviewBtn"
                    class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-2xl transition-all"
                >
                    Pular
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-emerald-600 to-green-700 text-center py-3">
        <p class="text-emerald-100 text-xs sm:text-sm">ü§ñ Bot-megas VODACOM ‚Ä¢ Atendimento 24/7</p>
    </footer>

    <script>
        // State Management
        let state = {
            currentStep: 'welcome',
            userPhone: '',
            selectedPackage: null,
            packageType: '',
            rating: 0,
            reviews: JSON.parse(localStorage.getItem('botMegasReviews') || '[]')
        };

        // Default reviews if none exist
        if (state.reviews.length === 0) {
            state.reviews = [
                { name: 'Jo√£o M.', rating: 5, text: 'Servi√ßo r√°pido e confi√°vel! Recebi meus megas em 5 minutos.', date: '2 dias atr√°s' },
                { name: 'Maria S.', rating: 5, text: 'Melhor pre√ßo que encontrei. J√° √© minha terceira compra!', date: '5 dias atr√°s' },
                { name: 'Pedro L.', rating: 5, text: 'Atendimento excelente via WhatsApp. Super recomendo!', date: '1 semana atr√°s' },
                { name: 'Ana R.', rating: 4, text: 'Bom servi√ßo, megas chegaram certinho. Obrigada!', date: '1 semana atr√°s' }
            ];
        }

        const packages = {
            diario: [
                { gb: 1, price: 18 },
                { gb: 2, price: 36 },
                { gb: 3, price: 54 },
                { gb: 5, price: 90 },
                { gb: 10, price: 180 }
            ],
            semanal: [
                { gb: 6, price: 140 },
                { gb: 7, price: 155 },
                { gb: 9, price: 175 },
                { gb: 10, price: 215 }
            ],
            mensal: [
                { gb: 7, price: 185 },
                { gb: 10, price: 280 },
                { gb: 17, price: 450 }
            ]
        };

        // DOM Elements
        const messagesArea = document.getElementById('messagesArea');
        const inputArea = document.getElementById('inputArea');
        const phoneInput = document.getElementById('phoneInput');
        const sendBtn = document.getElementById('sendBtn');
        const reviewModal = document.getElementById('reviewModal');
        const starRating = document.getElementById('starRating');
        const reviewText = document.getElementById('reviewText');
        const submitReviewBtn = document.getElementById('submitReviewBtn');
        const skipReviewBtn = document.getElementById('skipReviewBtn');

        // Initialize star rating
        function initStarRating() {
            starRating.innerHTML = '';
            for (let i = 1; i <= 5; i++) {
                const star = document.createElement('button');
                star.innerHTML = `
                    <svg class="w-8 h-8 sm:w-10 sm:h-10 transition-transform hover:scale-125 ${i <= state.rating ? 'fill-yellow-400 text-yellow-400' : 'text-gray-300'}" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                `;
                star.onclick = () => {
                    state.rating = i;
                    initStarRating();
                };
                starRating.appendChild(star);
            }
        }

        // Add message to chat
        function addMessage(text, type, data = null) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'animate-slide-up mb-4';
            
            const time = new Date().toLocaleTimeString('pt-PT', { hour: '2-digit', minute: '2-digit' });
            
            if (type === 'user') {
                msgDiv.innerHTML = `
                    <div class="flex justify-end">
                        <div class="bg-gradient-to-r from-emerald-500 to-green-600 text-white rounded-3xl px-4 sm:px-6 py-3 shadow-md max-w-md">
                            <p class="text-sm sm:text-lg">${text}</p>
                            <p class="text-xs text-emerald-100 mt-1">${time}</p>
                        </div>
                    </div>
                `;
            } else {
                msgDiv.innerHTML = `
                    <div class="flex justify-start">
                        <div class="max-w-full sm:max-w-2xl">
                            ${data ? data : `
                                <div class="bg-white rounded-3xl shadow-md p-4 sm:p-6 border border-gray-100">
                                    <p class="text-gray-800 text-sm sm:text-lg">${text}</p>
                                </div>
                            `}
                            <p class="text-xs text-gray-400 mt-2">${time}</p>
                        </div>
                    </div>
                `;
            }
            
            messagesArea.appendChild(msgDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        // Welcome message
        function showWelcome() {
            const stats = `
                <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-8 border-2 border-green-100">
                    <p class="text-lg sm:text-xl text-gray-800 mb-4 sm:mb-6">Ol√°! üëã Bem-vindo ao Bot-megas VODACOM</p>
                    <p class="text-sm sm:text-base text-gray-600 mb-4 sm:mb-6">üá≤üáø Refer√™ncia em vendas de megabytes em Mo√ßambique</p>
                    
                    <div class="bg-gradient-to-br from-emerald-50 to-green-50 rounded-2xl p-4 sm:p-6 mb-4 sm:mb-6 border border-emerald-200">
                        <div class="grid grid-cols-3 gap-2 sm:gap-4 text-center">
                            <div class="px-1">
                                <div class="text-xl sm:text-3xl font-bold text-emerald-600">2.5K+</div>
                                <div class="text-xs sm:text-sm text-gray-600 mt-1">Clientes</div>
                            </div>
                            <div class="px-1 border-x border-emerald-200">
                                <div class="text-xl sm:text-3xl font-bold text-emerald-600">4.9</div>
                                <div class="flex items-center justify-center mt-1 gap-0.5">
                                    ${[1,2,3,4,5].map(() => `
                                        <svg class="w-3 h-3 sm:w-4 sm:h-4 fill-yellow-400 text-yellow-400" viewBox="0 0 24 24">
                                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                        </svg>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="px-1">
                                <div class="text-xl sm:text-3xl font-bold text-emerald-600">5min</div>
                                <div class="text-xs sm:text-sm text-gray-600 mt-1">Entrega</div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4 sm:mb-6">
                        <h3 class="text-base sm:text-lg font-bold text-gray-800 mb-3 flex items-center">
                            <svg class="w-4 h-4 sm:w-5 sm:h-5 mr-2 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                            </svg>
                            Avalia√ß√µes Recentes
                        </h3>
                        <div class="space-y-3 max-h-60 overflow-y-auto">
                            ${state.reviews.slice(0, 3).map(review => `
                                <div class="bg-gray-50 rounded-xl p-3 sm:p-4 border border-gray-200">
                                    <div class="flex items-start justify-between mb-2 gap-2">
                                        <span class="font-semibold text-gray-800 text-sm sm:text-base">${review.name}</span>
                                        <div class="flex gap-0.5 flex-shrink-0">
                                            ${[1,2,3,4,5].map(i => `
                                                <svg class="w-3 h-3 sm:w-4 sm:h-4 ${i <= review.rating ? 'fill-yellow-400 text-yellow-400' : 'text-gray-300'}" viewBox="0 0 24 24">
                                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                                </svg>
                                            `).join('')}
                                        </div>
                                    </div>
                                    <p class="text-gray-700 text-xs sm:text-sm mb-2">${review.text}</p>
                                    <span class="text-xs text-gray-500">${review.date}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="space-y-3">
                        <button onclick="startOrder()" class="w-full bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white font-semibold py-3 sm:py-4 px-6 rounded-2xl shadow-md transition-all transform hover:scale-105 flex items-center justify-center space-x-2">
                            <span>üöÄ</span>
                            <span>Comprar Megas Agora</span>
                        </button>
                        <button onclick="showPrices()" class="w-full bg-white hover:bg-gray-50 text-emerald-700 font-semibold py-3 sm:py-4 px-6 rounded-2xl shadow-md transition-all border-2 border-emerald-200 hover:border-emerald-400">
                            üìä Ver Tabela de Pre√ßos
                        </button>
                    </div>
                </div>
            `;
            addMessage('', 'bot', stats);
        }

        // Start order flow
        function startOrder() {
            addMessage('Quero comprar megas', 'user');
            setTimeout(() => {
                addMessage('Primeiro, qual √© o seu n√∫mero Vodacom?', 'bot');
                setTimeout(() => {
                    const hint = `<div class="bg-blue-50 rounded-2xl p-4 border border-blue-200 mt-2"><p class="text-blue-700 text-xs sm:text-sm">üí° Digite no formato: 258840000000</p></div>`;
                    addMessage('', 'bot', hint);
                    state.currentStep = 'ask_phone';
                    inputArea.classList.remove('hidden');
                    phoneInput.focus();
                }, 400);
            }, 600);
        }

        // Show prices
        function showPrices() {
            addMessage('Ver tabela de pre√ßos', 'user');
            setTimeout(() => {
                const types = `
                    <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-green-100">
                        <p class="text-base sm:text-lg text-gray-800 mb-4">Escolha o tipo de pacote:</p>
                        <div class="grid grid-cols-1 gap-3">
                            <button onclick="showPackages('diario')" class="bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-3 sm:py-4 px-6 rounded-xl shadow-md transition-all transform hover:scale-105">
                                ‚ö° Pacotes Di√°rios
                            </button>
                            <button onclick="showPackages('semanal')" class="bg-gradient-to-r from-blue-400 to-blue-500 hover:from-blue-500 hover:to-blue-600 text-white font-semibold py-3 sm:py-4 px-6 rounded-xl shadow-md transition-all transform hover:scale-105">
                                üìÖ Pacotes Semanais
                            </button>
                            <button onclick="showPackages('mensal')" class="bg-gradient-to-r from-purple-400 to-purple-500 hover:from-purple-500 hover:to-purple-600 text-white font-semibold py-3 sm:py-4 px-6 rounded-xl shadow-md transition-all transform hover:scale-105">
                                üìÜ Pacotes Mensais
                            </button>
                        </div>
                    </div>
                `;
                addMessage('', 'bot', types);
            }, 600);
        }

        // Show package options
        function showPackages(type) {
            const typeNames = {
                diario: 'Pacotes Di√°rios ‚ö°',
                semanal: 'Pacotes Semanais üìÖ',
                mensal: 'Pacotes Mensais üìÜ'
            };
            addMessage(typeNames[type], 'user');
            state.packageType = type;
            
            setTimeout(() => {
                const pkgs = `
                    <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-green-100">
                        <p class="text-lg sm:text-xl font-bold text-gray-800 mb-4">${typeNames[type]}</p>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            ${packages[type].map(pkg => `
                                <button onclick='selectPackage(${JSON.stringify(pkg)})' class="bg-gradient-to-br from-emerald-50 to-green-50 hover:from-emerald-100 hover:to-green-100 border-2 border-emerald-300 rounded-xl p-4 transition-all transform hover:scale-105 hover:shadow-lg">
                                    <div class="text-2xl sm:text-3xl mb-2">üåê</div>
                                    <div class="text-xl sm:text-2xl font-bold text-emerald-700">${pkg.gb}GB</div>
                                    <div class="text-lg sm:text-xl font-semibold text-gray-700 mt-1">${pkg.price} MT</div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
                addMessage('', 'bot', pkgs);
            }, 600);
        }

        // Select package
        function selectPackage(pkg) {
            if (!state.userPhone) {
                addMessage(`Escolho ${pkg.gb}GB por ${pkg.price}MT`, 'user');
                setTimeout(() => {
                    const error = `<div class="bg-red-50 rounded-2xl p-4 border border-red-200 flex items-center space-x-3"><svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg><p class="text-red-700 text-sm sm:text-base">Ops! Primeiro preciso do seu n√∫mero. Vamos come√ßar do in√≠cio?</p></div>`;
                    addMessage('', 'bot', error);
                    setTimeout(() => startOrder(), 1500);
                }, 600);
                return;
            }

            addMessage(`Escolho ${pkg.gb}GB por ${pkg.price}MT`, 'user');
            state.selectedPackage = pkg;
            
            setTimeout(() => {
                const confirm = `
                    <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-green-100">
                        <p class="text-lg sm:text-xl font-bold text-gray-800 mb-4">Confirme seu pedido:</p>
                        <div class="bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl p-4 sm:p-6 mb-4 border border-emerald-200">
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm sm:text-base text-gray-600">Pacote:</span>
                                    <span class="text-lg sm:text-xl font-bold text-emerald-700">${pkg.gb}GB</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm sm:text-base text-gray-600">Valor:</span>
                                    <span class="text-lg sm:text-xl font-bold text-gray-800">${pkg.price} MT</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm sm:text-base text-gray-600">N√∫mero:</span>
                                    <span class="text-sm sm:text-base font-mono text-gray-800">${state.userPhone}</span>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="confirmOrder(true)" class="bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white font-semibold py-3 px-4 sm:px-6 rounded-xl shadow-md transition-all text-sm sm:text-base">
                                ‚úì Confirmar
                            </button>
                            <button onclick="confirmOrder(false)" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-4 sm:px-6 rounded-xl transition-all text-sm sm:text-base">
                                ‚úó Cancelar
                            </button>
                        </div>
                    </div>
                `;
                addMessage('', 'bot', confirm);
                state.currentStep = 'confirm_order';
            }, 600);
        }

        // Confirm order
        function confirmOrder(confirmed) {
            if (confirmed) {
                addMessage('Confirmo o pedido', 'user');
                setTimeout(() => {
                    const payment = `
                        <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-green-100">
                            <div class="text-center mb-6">
                                <div class="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-3">
                                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                    </svg>
                                </div>
                                <p class="text-xl sm:text-2xl font-bold text-gray-800">Pedido confirmado! üéâ</p>
                            </div>

                            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 sm:p-6 mb-6 border border-blue-200">
                                <p class="font-bold text-base sm:text-lg text-gray-800 mb-4">üí≥ Dados para Pagamento:</p>
                                <div class="space-y-3 text-gray-700">
                                    <div>
                                        <p class="text-xs sm:text-sm text-gray-600">M-Pesa:</p>
                                        <p class="font-mono text-base sm:text-lg font-bold">869984236</p>
                                    </div>
                                    <div>
                                        <p class="text-xs sm:text-sm text-gray-600">E-Mola:</p>
                                        <p class="font-mono text-base sm:text-lg font-bold">853704955</p>
                                    </div>
                                    <div>
                                        <p class="text-xs sm:text-sm text-gray-600">Nome:</p>
                                        <p class="text-sm sm:text-base font-semibold">Ndzutine Mungoi</p>
                                    </div>
                                    <div class="pt-3 border-t border-blue-200">
                                        <p class="text-xs sm:text-sm text-gray-600">Valor:</p>
                                        <p class="text-xl sm:text-2xl font-bold text-emerald-600">${state.selectedPackage.price} MT</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-yellow-50 rounded-xl p-4 mb-4 border border-yellow-200">
                                <p class="text-xs sm:text-sm font-semibold text-yellow-800 mb-2">üìã Pr√≥ximos passos:</p>
                                <ol class="text-xs sm:text-sm text-yellow-700 space-y-1 list-decimal list-inside">
                                    <li>Fa√ßa o pagamento de ${state.selectedPackage.price} MT</li>
                                    <li>Tire print do comprovativo</li>
                                    <li>Envie para nosso suporte</li>
                                    <li>Aguarde 2-10 minutos</li>
                                </ol>
                            </div>

                            <div class="space-y-3">
                                <a href="${generateWhatsAppLink()}" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center space-x-3 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold py-3 sm:py-4 px-6 rounded-2xl shadow-lg transition-all transform hover:scale-105">
                                    <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/>
                                    </svg>
                                    <span class="text-sm sm:text-base">Enviar Comprovativo no WhatsApp</span>
                                </a>

                                <button onclick="megasReceived()" class="w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 sm:py-4 px-6 rounded-2xl shadow-lg transition-all transform hover:scale-105">
                                    ‚úì J√° Recebi os Megas
                                </button>
                            </div>
                        </div>
                    `;
                    addMessage('', 'bot', payment);
                    state.currentStep = 'payment';
                }, 600);
            } else {
                addMessage('Cancelar pedido', 'user');
                setTimeout(() => {
                    addMessage('Pedido cancelado. Posso ajudar com algo mais?', 'bot');
                    state.currentStep = 'welcome';
                    state.selectedPackage = null;
                    state.userPhone = '';
                    state.packageType = '';
                    setTimeout(() => showWelcome(), 1000);
                }, 600);
            }
        }

        // Generate WhatsApp link
        function generateWhatsAppLink() {
            const message = `ü§ñ NOVO PEDIDO BOT-MEGAS

üì± N√∫mero: ${state.userPhone}
üì¶ Pacote: ${state.selectedPackage.gb}GB - ${state.selectedPackage.price}MT
‚è∞ ${new Date().toLocaleString('pt-PT')}

Cliente aguardando valida√ß√£o!`;
            return `https://wa.me/258858157241?text=${encodeURIComponent(message)}`;
        }

        // Megas received
        function megasReceived() {
            addMessage('Recebi os megas!', 'user');
            setTimeout(() => {
                const success = `<div class="bg-green-50 rounded-2xl p-4 border border-green-200 flex items-center space-x-3"><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg><p class="text-green-700 font-medium text-sm sm:text-base">Que √≥timo! üéâ Obrigado por escolher Bot-megas VODACOM!</p></div>`;
                addMessage('', 'bot', success);
                setTimeout(() => {
                    reviewModal.classList.remove('hidden');
                    initStarRating();
                }, 1000);
            }, 600);
        }

        // Submit review
        submitReviewBtn.onclick = function() {
            if (state.rating === 0) {
                alert('Por favor, selecione uma classifica√ß√£o com estrelas');
                return;
            }

            const newReview = {
                name: state.userPhone.slice(-4) + '****',
                rating: state.rating,
                text: reviewText.value || 'Excelente servi√ßo!',
                date: 'Agora'
            };

            state.reviews.unshift(newReview);
            localStorage.setItem('botMegasReviews', JSON.stringify(state.reviews));
            
            reviewModal.classList.add('hidden');
            
            setTimeout(() => {
                const success = `<div class="bg-green-50 rounded-2xl p-4 border border-green-200 flex items-center space-x-3"><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg><p class="text-green-700 font-medium text-sm sm:text-base">Obrigado pela sua avalia√ß√£o! üåü</p></div>`;
                addMessage('', 'bot', success);
                setTimeout(() => endSession(), 1500);
            }, 600);
        };

        // Skip review
        skipReviewBtn.onclick = function() {
            reviewModal.classList.add('hidden');
            setTimeout(() => endSession(), 600);
        };

        // End session
        function endSession() {
            const end = `
                <div class="bg-gradient-to-br from-emerald-50 to-green-50 rounded-3xl shadow-lg p-6 sm:p-8 border-2 border-green-200 text-center">
                    <div class="text-5xl sm:text-6xl mb-4">üëã</div>
                    <p class="text-xl sm:text-2xl font-bold text-gray-800 mb-2">Sess√£o encerrada. At√© a pr√≥xima!</p>
                    <p class="text-sm sm:text-base text-gray-600">Voltando ao in√≠cio em instantes...</p>
                </div>
            `;
            addMessage('', 'bot', end);
            
            setTimeout(() => {
                messagesArea.innerHTML = '';
                state = {
                    currentStep: 'welcome',
                    userPhone: '',
                    selectedPackage: null,
                    packageType: '',
                    rating: 0,
                    reviews: JSON.parse(localStorage.getItem('botMegasReviews') || '[]')
                };
                if (state.reviews.length === 0) {
                    state.reviews = [
                        { name: 'Jo√£o M.', rating: 5, text: 'Servi√ßo r√°pido e confi√°vel! Recebi meus megas em 5 minutos.', date: '2 dias atr√°s' },
                        { name: 'Maria S.', rating: 5, text: 'Melhor pre√ßo que encontrei. J√° √© minha terceira compra!', date: '5 dias atr√°s' },
                        { name: 'Pedro L.', rating: 5, text: 'Atendimento excelente via WhatsApp. Super recomendo!', date: '1 semana atr√°s' },
                        { name: 'Ana R.', rating: 4, text: 'Bom servi√ßo, megas chegaram certinho. Obrigada!', date: '1 semana atr√°s' }
                    ];
                }
                reviewText.value = '';
                inputArea.classList.add('hidden');
                phoneInput.value = '';
                setTimeout(() => showWelcome(), 500);
            }, 3000);
        }

        // Handle phone input
        sendBtn.onclick = function() {
            const phone = phoneInput.value.trim().replace(/\s+/g, '');
            if (!phone) return;

            addMessage(phone, 'user');
            phoneInput.value = '';

            setTimeout(() => {
                const phoneRegex = /^258[0-9]{9}$/;
                
                if (phoneRegex.test(phone)) {
                    state.userPhone = phone;
                    const success = `<div class="bg-green-50 rounded-2xl p-4 border border-green-200 flex items-center space-x-3"><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg><p class="text-green-700 font-medium text-sm sm:text-base">Perfeito! N√∫mero ${phone} registrado ‚úì</p></div>`;
                    addMessage('', 'bot', success);
                    inputArea.classList.add('hidden');
                    setTimeout(() => {
                        addMessage('Agora escolha o tipo de pacote:', 'bot');
                        setTimeout(() => {
                            const types = `
                                <div class="bg-white rounded-3xl shadow-lg p-4 sm:p-6 border-2 border-green-100">
                                    <div class="grid grid-cols-1 gap-3">
                                        <button onclick="showPackages('diario')" class="bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-3 sm:py-4 px-6 rounded-xl shadow-md transition-all transform hover:scale-105">
                                            ‚ö° Pacotes Di√°rios
                                        </button>
                                        <button onclick="showPackages('semanal')" class="bg-gradient-to-r from-blue-400 to-blue-500 hover:from-blue-500 hover:to-blue-600 text-white font-semibold py-3 sm:py-4 px-6 rounded-xl shadow-md transition-all transform hover:scale-105">
                                            üìÖ Pacotes Semanais
                                        </button>
                                        <button onclick="showPackages('mensal')" class="bg-gradient-to-r from-purple-400 to-purple-500 hover:from-purple-500 hover:to-purple-600 text-white font-semibold py-3 sm:py-4 px-6 rounded-xl shadow-md transition-all transform hover:scale-105">
                                            üìÜ Pacotes Mensais
                                        </button>
                                    </div>
                                </div>
                            `;
                            addMessage('', 'bot', types);
                            state.currentStep = 'select_type';
                        }, 400);
                    }, 1000);
                } else {
                    const error = `<div class="bg-red-50 rounded-2xl p-4 border border-red-200 flex items-center space-x-3"><svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg><p class="text-red-700 text-sm sm:text-base">N√∫mero inv√°lido. Use o formato: 258840000000</p></div>`;
                    addMessage('', 'bot', error);
                }
            }, 600);
        };

        phoneInput.onkeypress = function(e) {
            if (e.key === 'Enter') {
                sendBtn.click();
            }
        };

        // Initialize
        setTimeout(() => showWelcome(), 500);
    </script>
</body>
</html>